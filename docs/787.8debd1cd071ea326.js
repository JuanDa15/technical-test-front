"use strict";(self.webpackChunktechnical_test_front=self.webpackChunktechnical_test_front||[]).push([[787,516],{787:(f,m,n)=>{n.r(m),n.d(m,{RoomModule:()=>z});var c=n(6814),l=n(3057),t=n(4946),u=n(7398),p=n(6306),d=n(2096),h=n(5516),v=n(9862);let g=(()=>{class e{get room(){return this._room.asReadonly()}constructor(o){this._http=o,this._URL=`${h.N.API}api/rooms`,this._room=(0,t.tdS)(null)}getRoomData(o){return this._http.get(`${this._URL}/${o}`).pipe((0,u.U)(({data:s})=>(this._room.set(s),!0)),(0,p.K)(()=>(0,d.of)(!1)))}updateRoom(o,s){return this._http.patch(`${this._URL}/${o}`,s).pipe((0,u.U)(({data:a})=>(this._room.set(a),!0)),(0,p.K)(()=>(0,d.of)(!1)))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(v.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var i=n(95),R=n(9200),y=n(4942),S=n(8645),x=n(9360),C=n(8251),U=n(4829),Z=n(2420),A=n(4664),F=n(2582),I=n(4641),T=n(4929),b=n(9768);function $(e,r){if(1&e&&(t.TgZ(0,"option",13),t._uU(1),t.qZA()),2&e){const o=r.$implicit;t.s9C("value",o.key),t.xp6(1),t.hij(" ",o.value," ")}}function N(e,r){if(1&e){const o=t.EpF();t.ynx(0),t.TgZ(1,"h1"),t._uU(2),t.qZA(),t.TgZ(3,"h2"),t._uU(4),t.qZA(),t.TgZ(5,"p")(6,"small"),t._uU(7),t.qZA()(),t.TgZ(8,"form",3),t.NdJ("ngSubmit",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.update())}),t.TgZ(9,"div",4)(10,"c-select-input",5),t.YNc(11,$,2,2,"option",6),t.ALo(12,"keyvalue"),t.qZA(),t._UZ(13,"c-number-input",7)(14,"c-number-input",8),t.qZA(),t._UZ(15,"c-checkbox-input",9),t.TgZ(16,"div",10)(17,"button",11),t._uU(18," Actualizar habitaci\xf3n "),t.qZA(),t.TgZ(19,"button",12),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.deleteRoom())}),t._uU(20," Eliminar habitaci\xf3n "),t.qZA()()(),t.BQk()}if(2&e){const o=t.oxw();let s;t.xp6(2),t.Oqu(o.hotelData()),t.xp6(2),t.AsE("Habitacion ",null==(s=o.specificRoomService.room())?null:s.code,", ",o.roomLocation(),""),t.xp6(3),t.hij("Ultima edici\xf3n: ",o.lastUpdated(),""),t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("ngForOf",t.lcZ(12,6,o.roomTypes))}}function J(e,r){1&e&&(t.TgZ(0,"div",14),t._UZ(1,"loader"),t.qZA())}const L=[{path:"update/:id",component:(()=>{class e{constructor(){this.ar=(0,t.f3M)(l.gz),this.router=(0,t.f3M)(l.F0),this.fb=(0,t.f3M)(i.qu),this.destroyRef=(0,t.f3M)(t.ktI),this.specificRoomService=(0,t.f3M)(g),this.roomService=(0,t.f3M)(R.X),this.notifications=(0,t.f3M)(y.g),this._stop$=new S.x,this.roomId=null,this.loading=!1,this.roomTypes={Suite:"Suite",JuniorSuite:"Junior suite",GranSuite:"Gran suite",Individual:"Individual",Double:"Doble",Quadruple:"Cuadruple"},this.form=this.fb.group({type:["",i.kI.required],taxes:["",i.kI.required],baseCost:["",i.kI.required],active:[!1,i.kI.required],_id:["",i.kI.required]}),this.lastUpdated=(0,t.Flj)(()=>{const o=this.specificRoomService.room()?.updatedBy;return`${o?.name} ${o?.lastName} < ${o?.email} >`}),this.hotelData=(0,t.Flj)(()=>{const o=this.specificRoomService.room()?.hotel;return`${o?.name} < ${o?.email} >`}),this.roomLocation=(0,t.Flj)(()=>{const o=this.specificRoomService.room()?.location;return`Piso: ${o?.floor}, Habitaci\xf3n: ${o?.room}`}),this.patchFormEffect=(0,t.cEC)(()=>{this.specificRoomService.room()&&this.form.patchValue(this.specificRoomService.room())}),this.destroyRef.onDestroy(()=>{this.patchFormEffect.destroy(),this._stop$.complete()})}ngOnInit(){this.loading=!0,this.ar.params.pipe(function M(e){return(0,x.e)((r,o)=>{(0,U.Xf)(e).subscribe((0,C.x)(o,()=>o.complete(),Z.Z)),!o.closed&&r.subscribe(o)})}(this._stop$),(0,A.w)(({id:o})=>(this.roomId=o,this.specificRoomService.getRoomData(o)))).subscribe({next:()=>{this.loading=!1}})}deleteRoom(){this.roomId&&this.roomService.delete(this.roomId).subscribe({next:()=>{this.notifications.create({severity:"success",summary:"Habitaci\xf3n eliminada"}),this.router.navigateByUrl("/priv/hotel/update/"+this.specificRoomService.room()?.hotel._id)}})}update(){const{_id:o,...s}=structuredClone(this.form.value);o&&this.specificRoomService.updateRoom(o,s).subscribe({next:()=>{this.notifications.create({severity:"success",summary:"Habitaci\xf3n actualizada"})}})}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-update"]],decls:4,vars:2,consts:[[1,"content-container"],[4,"ngIf","ngIfElse"],["loader",""],[3,"formGroup","ngSubmit"],[1,"controls-section"],["label","Tipo de Habitaci\xf3n*","formControlName","type"],[3,"value",4,"ngFor","ngForOf"],["label","impuestos(%)*","formControlName","taxes"],["label","Costo(Sin impuestos)*","formControlName","baseCost"],["label","Activo*","formControlName","active"],[1,"actions"],["type","submit",1,"primary-button"],["type","button",1,"danger-button",3,"click"],[3,"value"],[1,"loader-wrapper"]],template:function(o,s){if(1&o&&(t.TgZ(0,"section",0),t.YNc(1,N,21,8,"ng-container",1),t.qZA(),t.YNc(2,J,2,0,"ng-template",null,2,t.W1O)),2&o){const a=t.MAs(3);t.xp6(1),t.Q6J("ngIf",!s.loading)("ngIfElse",a)}},dependencies:[c.sg,c.O5,i._Y,i.YN,i.Kr,i.JJ,i.JL,i.sg,i.u,F.R,I.o,T.c,b.p,c.Nd],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-top:2rem}.controls-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:1rem}.loader-wrapper[_ngcontent-%COMP%]{width:100%;display:grid;place-items:center}.actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem}"]}),e})(),canActivate:[n(1841).WL]}];let j=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.Bz.forChild(L),l.Bz]}),e})();var B=n(8524);let z=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[c.ez,j,i.UX,B.m]}),e})()},5516:(f,m,n)=>{n.d(m,{N:()=>c});const c={API:"http://localhost:3000/"}}}]);