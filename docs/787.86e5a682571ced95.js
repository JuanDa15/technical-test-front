"use strict";(self.webpackChunktechnical_test_front=self.webpackChunktechnical_test_front||[]).push([[787,516],{787:(y,f,r)=>{r.r(f),r.d(f,{RoomModule:()=>J});var o=r(6814),u=r(3057),t=r(4946),g=r(7398),s=r(6306),l=r(2096),m=r(5516),c=r(9862);let C=(()=>{class a{get room(){return this._room.asReadonly()}constructor(n){this._http=n,this._URL=`${m.N.API}api/rooms`,this._room=(0,t.tdS)(null)}getRoomData(n){return this._http.get(`${this._URL}/${n}`).pipe((0,g.U)(({data:d})=>(this._room.set(d),!0)),(0,s.K)(()=>(0,l.of)(!1)))}updateRoom(n,d){return this._http.patch(`${this._URL}/${n}`,d).pipe((0,g.U)(({data:b})=>(this._room.set(b),!0)),(0,s.K)(()=>(0,l.of)(!1)))}}return a.\u0275fac=function(n){return new(n||a)(t.LFG(c.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var e=r(95),i=r(9200),h=r(4942),v=r(8645),_=r(9360),x=r(8251),I=r(4829),O=r(2420),R=r(4664),T=r(2582),S=r(4641),N=r(4929),D=r(9768);function U(a,p){if(1&a&&(t.TgZ(0,"option",13),t._uU(1),t.qZA()),2&a){const n=p.$implicit;t.s9C("value",n.key),t.xp6(1),t.hij(" ",n.value," ")}}function Z(a,p){if(1&a){const n=t.EpF();t.ynx(0),t.TgZ(1,"h1"),t._uU(2),t.qZA(),t.TgZ(3,"h2"),t._uU(4),t.qZA(),t.TgZ(5,"p")(6,"small"),t._uU(7),t.qZA()(),t.TgZ(8,"form",3),t.NdJ("ngSubmit",function(){t.CHM(n);const b=t.oxw();return t.KtG(b.update())}),t.TgZ(9,"div",4)(10,"c-select-input",5),t.YNc(11,U,2,2,"option",6),t.ALo(12,"keyvalue"),t.qZA(),t._UZ(13,"c-number-input",7)(14,"c-number-input",8),t.qZA(),t._UZ(15,"c-checkbox-input",9),t.TgZ(16,"div",10)(17,"button",11),t._uU(18," Actualizar habitaci\xf3n "),t.qZA(),t.TgZ(19,"button",12),t.NdJ("click",function(){t.CHM(n);const b=t.oxw();return t.KtG(b.deleteRoom())}),t._uU(20," Eliminar habitaci\xf3n "),t.qZA()()(),t.BQk()}if(2&a){const n=t.oxw();let d;t.xp6(2),t.Oqu(n.hotelData()),t.xp6(2),t.AsE("Habitacion ",null==(d=n.specificRoomService.room())?null:d.code,", ",n.roomLocation(),""),t.xp6(3),t.hij("Ultima edici\xf3n: ",n.lastUpdated(),""),t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(3),t.Q6J("ngForOf",t.lcZ(12,6,n.roomTypes))}}function F(a,p){1&a&&(t.TgZ(0,"div",14),t._UZ(1,"loader"),t.qZA())}const P=[{path:"update/:id",component:(()=>{class a{constructor(){this.ar=(0,t.f3M)(u.gz),this.router=(0,t.f3M)(u.F0),this.fb=(0,t.f3M)(e.qu),this.destroyRef=(0,t.f3M)(t.ktI),this.specificRoomService=(0,t.f3M)(C),this.roomService=(0,t.f3M)(i.X),this.notifications=(0,t.f3M)(h.g),this._stop$=new v.x,this.roomId=null,this.loading=!1,this.roomTypes={Suite:"Suite",JuniorSuite:"Junior suite",GranSuite:"Gran suite",Individual:"Individual",Double:"Doble",Quadruple:"Cuadruple"},this.form=this.fb.group({type:["",e.kI.required],taxes:["",e.kI.required],baseCost:["",e.kI.required],active:[!1,e.kI.required],_id:["",e.kI.required]}),this.lastUpdated=(0,t.Flj)(()=>{const n=this.specificRoomService.room()?.updatedBy;return`${n?.name} ${n?.lastName} < ${n?.email} >`}),this.hotelData=(0,t.Flj)(()=>{const n=this.specificRoomService.room()?.hotel;return`${n?.name} < ${n?.email} >`}),this.roomLocation=(0,t.Flj)(()=>{const n=this.specificRoomService.room()?.location;return`Piso: ${n?.floor}, Habitaci\xf3n: ${n?.room}`}),this.patchFormEffect=(0,t.cEC)(()=>{this.specificRoomService.room()&&this.form.patchValue(this.specificRoomService.room())}),this.destroyRef.onDestroy(()=>{this.patchFormEffect.destroy(),this._stop$.complete()})}ngOnInit(){this.loading=!0,this.ar.params.pipe(function M(a){return(0,_.e)((p,n)=>{(0,I.Xf)(a).subscribe((0,x.x)(n,()=>n.complete(),O.Z)),!n.closed&&p.subscribe(n)})}(this._stop$),(0,R.w)(({id:n})=>(this.roomId=n,this.specificRoomService.getRoomData(n)))).subscribe({next:()=>{this.loading=!1}})}deleteRoom(){this.roomId&&this.roomService.delete(this.roomId).subscribe({next:()=>{this.notifications.create({severity:"success",summary:"Habitaci\xf3n eliminada"}),this.router.navigateByUrl("/priv/hotel/update/"+this.specificRoomService.room()?.hotel._id)}})}update(){const{_id:n,...d}=structuredClone(this.form.value);n&&this.specificRoomService.updateRoom(n,d).subscribe({next:()=>{this.notifications.create({severity:"success",summary:"Habitaci\xf3n actualizada"})}})}}return a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-update"]],decls:4,vars:2,consts:[[1,"content-container"],[4,"ngIf","ngIfElse"],["loader",""],[3,"formGroup","ngSubmit"],[1,"controls-section"],["label","Tipo de Habitaci\xf3n*","formControlName","type"],[3,"value",4,"ngFor","ngForOf"],["label","impuestos(%)*","formControlName","taxes"],["label","Costo(Sin impuestos)*","formControlName","baseCost"],["label","Activo*","formControlName","active"],[1,"actions"],["type","submit",1,"primary-button"],["type","button",1,"danger-button",3,"click"],[3,"value"],[1,"loader-wrapper"]],template:function(n,d){if(1&n&&(t.TgZ(0,"section",0),t.YNc(1,Z,21,8,"ng-container",1),t.qZA(),t.YNc(2,F,2,0,"ng-template",null,2,t.W1O)),2&n){const b=t.MAs(3);t.xp6(1),t.Q6J("ngIf",!d.loading)("ngIfElse",b)}},dependencies:[o.sg,o.O5,e._Y,e.YN,e.Kr,e.JJ,e.JL,e.sg,e.u,T.R,S.o,N.c,D.p,o.Nd],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-top:2rem}.controls-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:1rem}.loader-wrapper[_ngcontent-%COMP%]{width:100%;display:grid;place-items:center}.actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem}"]}),a})(),canActivate:[r(1841).WL]}];let L=(()=>{class a{}return a.\u0275fac=function(n){return new(n||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[u.Bz.forChild(P),u.Bz]}),a})();var $=r(8524);let J=(()=>{class a{}return a.\u0275fac=function(n){return new(n||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[o.ez,L,e.UX,$.m]}),a})()},4929:(y,f,r)=>{r.d(f,{c:()=>m});var o=r(4946),u=r(95),t=r(9098),g=r(6814);let s=(()=>{class c{constructor(e,i){this._el=e,this._control=i,this.allowDecimals=!1}onInputChange(e){const i=this._getCharCode(e);if(i){if(32===i)return void this._control?.control?.setValue(this._el.nativeElement.value.trim());if(i>=48&&i<=57||this.allowDecimals&&46===i)return;let h=this._el.nativeElement.value;h=h.slice(0,h.length-1),this._control?.control?.setValue(h)}}_getCharCode(e){return e.data?.charCodeAt(e.data.length-1)}}return c.\u0275fac=function(e){return new(e||c)(o.Y36(o.SBq),o.Y36(u.a5))},c.\u0275dir=o.lG2({type:c,selectors:[["","OnlyNumbers",""]],hostBindings:function(e,i){1&e&&o.NdJ("input",function(v){return i.onInputChange(v)})},inputs:{allowDecimals:"allowDecimals"}}),c})();function l(c,C){if(1&c&&(o.TgZ(0,"p",4),o._uU(1),o.qZA()),2&c){const e=o.oxw();o.xp6(1),o.hij(" ",e.formHelper.getControlErrors(e.controlInstance)," ")}}let m=(()=>{class c{constructor(e,i,h){this.formHelper=e,this._fb=i,this._destroyRef=h,this.onChange=v=>v,this.onTouch=()=>{},this.onValidatorChange=()=>{},this.id="",this.label="",this.allowDecimals=!1,this._subscriptions=[],this.controlInstance=null,this.form=this._initializeForm(),this._subscribeToValueChanges(),this._destroyRef.onDestroy(()=>{this._subscriptions.forEach(v=>v.unsubscribe())})}writeValue(e){null!==e&&(this.form.setValue(e),this.onChange(e))}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouch=e}setDisabledState(e){e?this.form.disable():this.form.enable()}validate(e){return this.controlInstance=e,null}registerOnValidatorChange(e){this.onValidatorChange=e}_initializeForm(){return this._fb.control(null,{updateOn:"change"})}_subscribeToValueChanges(){const e=this.form.valueChanges.subscribe({next:i=>{this.onValidatorChange(),this.onTouch(),this.onChange(i?i.toString():"")}});this._subscriptions.push(e)}markAsTouch(){this.controlInstance?.markAsDirty(),this.onTouch(),this.onValidatorChange()}avoidLetters(e){const i=e.clipboardData?.getData("text")||"";if(i&&i.match(/[a-zA-Z]+/))return e.target.value="",this.form.reset(),e.preventDefault(),void e.stopPropagation()}}return c.\u0275fac=function(e){return new(e||c)(o.Y36(t.k),o.Y36(u.qu),o.Y36(o.ktI))},c.\u0275cmp=o.Xpm({type:c,selectors:[["c-number-input"]],inputs:{id:"id",label:"label",name:"name",allowDecimals:"allowDecimals"},features:[o._Bn([{provide:u.JU,useExisting:(0,o.Gpc)(()=>c),multi:!0},{provide:u.Cf,useExisting:(0,o.Gpc)(()=>c),multi:!0}])],decls:5,vars:9,consts:[[1,"input-container"],[1,"input-label"],["type","number","OnlyNumbers","","autocomplete","off",1,"input",3,"formControl","name","allowDecimals","blur","paste"],["class","input-error",4,"ngIf"],[1,"input-error"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0)(1,"label",1),o._uU(2),o.qZA(),o.TgZ(3,"input",2),o.NdJ("blur",function(){return i.markAsTouch()})("paste",function(v){return i.avoidLetters(v)}),o.qZA(),o.YNc(4,l,2,1,"p",3),o.qZA()),2&e&&(o.ekj("error",null!==i.controlInstance&&i.formHelper.checkControlErrors(i.controlInstance)),o.xp6(1),o.uIk("for",i.id?i.id:null),o.xp6(1),o.Oqu(i.label),o.xp6(1),o.s9C("name",i.name?i.name:null),o.Q6J("formControl",i.form)("allowDecimals",i.allowDecimals),o.uIk("id",i.id?i.id:null),o.xp6(1),o.Q6J("ngIf",null!==i.controlInstance&&i.formHelper.checkControlErrors(i.controlInstance)))},dependencies:[g.O5,u.Fj,u.wV,u.JJ,u.oH,s],styles:[".input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-container[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{font-size:.9rem}.input-container[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{background:var(--bg);border:none;padding:.4rem .6rem;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:1px solid var(--primary);color:var(--text);border-radius:.3rem;transition:border .3s ease}.input-container[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]:focus{outline:none;border-radius:.3rem;border:1px solid var(--primary)}.input-container.error[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{color:var(--error)}.input-container.error[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{border:1px solid var(--error)}.input-container.error[_ngcontent-%COMP%]   .input-error[_ngcontent-%COMP%]{font-size:.9rem;color:var(--error)}"]}),c})()},2582:(y,f,r)=>{r.d(f,{R:()=>u});var o=r(4946);let u=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["loader"]],decls:1,vars:0,consts:[[1,"lds-dual-ring"]],template:function(s,l){1&s&&o._UZ(0,"div",0)},styles:['.lds-dual-ring[_ngcontent-%COMP%]{display:inline-block;width:100%;display:flex;justify-content:center;align-items:center}.lds-dual-ring[_ngcontent-%COMP%]:after{content:" ";display:block;width:64px;height:64px;margin:8px;border-radius:50%;border:3px solid var(--primary);border-color:var(--primary) transparent var(--primary) transparent;animation:_ngcontent-%COMP%_lds-dual-ring 1.2s linear infinite}@keyframes _ngcontent-%COMP%_lds-dual-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']}),t})()},9098:(y,f,r)=>{r.d(f,{k:()=>u});var o=r(4946);let u=(()=>{class t{checkFormErrors(s,l){const m=s.get(l);return m?.touched&&m.invalid}getFormErrors(s,l){const m=s.get(l)?.errors;return this._errorsDicc(m)}checkControlErrors(s){return s.invalid&&s.touched}getControlErrors(s){return this._errorsDicc(s.errors)}_errorsDicc(s){if(s?.required)return"Este campo es requerido";if(s?.email)return"No cumple con un formato de correo v\xe1lido";if(s?.maxlength){const{requiredLength:l,actualLength:m}=s.maxlength;return`Longitud m\xe1xima permitida ${l}, longitud actual ${m}`}if(s?.minlength){const{requiredLength:l,actualLength:m}=s.minlength;return`Longitud m\xednima permitida ${l}, longitud actual ${m}`}if(s?.invalidPasswordFormat)return"No cumple con el formato requerido: al menos una letra may\xfascula, al menos una letra min\xfascula, al menos un d\xedgito, sin espacios en blanco, m\xednimo 7 caracteres y m\xe1ximo 10.";if(s?.passwordNotMatch)return"Las contrase\xf1as no coinciden";if(s?.pattern)return"No cumple con el formato requerido";if(s?.max){const{actual:l,max:m}=s.max;return`El valor m\xe1ximo permitido es ${m}, valor actual ${l}`}if(s?.min){const{actual:l,min:m}=s.min;return`El valor m\xednimo permitido es ${m}, valor actual ${l}`}return""}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},5516:(y,f,r)=>{r.d(f,{N:()=>o});const o={API:"https://technical-test-back.azurewebsites.net/"}}}]);